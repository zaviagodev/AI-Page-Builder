"use strict";(()=>{var e={};e.id=3770,e.ids=[3770],e.modules={8013:e=>{e.exports=require("mongodb")},614:e=>{e.exports=require("next-auth/jwt")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5248:(e,t,a)=>{a.r(t),a.d(t,{config:()=>c,default:()=>d,routeModule:()=>p});var s={};a.r(s),a.d(s,{default:()=>u});var n=a(1802),i=a(7153),l=a(6249),o=a(3919),r=a(614);async function handler(e,t){let a;let s=await (0,r.getToken)({req:e});if(!s){t.status(200).json({ok:!0,status:401,error:"Not authenticated!"});return}let n=s.name;if("POST"!==e.method)return;let i=JSON.parse(e.body),l=i.slug,u=i.html,d=i.mainCss,c=i.sectionCss;try{a=await (0,o.T)()}catch(e){t.status(200).json({ok:!0,status:500,error:"Connecting to the database failed."});return}try{let e=a.db();await e.collection("pages").updateOne({slug:l,username:n},{$set:{html:u,mainCss:d,sectionCss:c,online:!0}});let s=await e.collection("pages").find({slug:l,username:n}).toArray(),i=await e.collection("pages_published").find({slug:l,username:n}).toArray();if(0===i.length){let t=s[0];delete t.online,delete t._id,await e.collection("pages_published").insertOne(t)}else{let t=s[0];delete t.online,delete t._id,await e.collection("pages_published").updateOne({slug:l,username:n},{$set:t})}await a.close(),t.status(200).json({ok:!0,status:200})}catch(e){await a.close(),t.status(200).json({ok:!0,status:500,error:"Something went wrong."})}}let u=handler,d=(0,l.l)(s,"default"),c=(0,l.l)(s,"config"),p=new n.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/contentpublish",pathname:"/api/contentpublish",bundlePath:"",filename:""},userland:s})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[4222,3919],()=>__webpack_exec__(5248));module.exports=a})();