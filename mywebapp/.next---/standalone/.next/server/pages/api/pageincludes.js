"use strict";(()=>{var e={};e.id=8288,e.ids=[8288],e.modules={8013:e=>{e.exports=require("mongodb")},614:e=>{e.exports=require("next-auth/jwt")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6657:(e,t,s)=>{s.r(t),s.d(t,{config:()=>d,default:()=>c,routeModule:()=>p});var a={};s.r(a),s.d(a,{default:()=>i});var n=s(1802),o=s(7153),u=s(6249),r=s(3919),l=s(614);async function handler(e,t){if("POST"===e.method){let s;let a=await (0,l.getToken)({req:e});if(!a){t.status(200).json({ok:!0,status:401,error:"Not authenticated!"});return}let n=a.name;try{s=await (0,r.T)()}catch(e){t.status(200).json({ok:!0,status:500,error:"Connecting to the database failed."});return}let o=JSON.parse(e.body),u=o.action,i=o.slug;if("get"===u)try{let e=s.db(),a=await e.collection("pages").findOne({slug:i,username:n});await s.close(),t.status(200).json({ok:!0,status:200,jsIncludes:a.jsIncludes,cssIncludes:a.cssIncludes})}catch(e){await s.close(),t.status(500).json({ok:!0,status:500,error:"Something went wrong."})}else{let e=o.slug,a=o.jsIncludes,u=o.cssIncludes;try{let o=s.db(),r={slug:e,username:n},l={$set:{jsIncludes:a,cssIncludes:u}};await o.collection("pages").updateOne(r,l),await o.collection("pages_published").updateOne(r,l),await s.close(),t.status(200).json({ok:!0,status:201})}catch(e){await s.close(),t.status(200).json({ok:!0,status:500,error:"Something went wrong."})}}}}let i=handler,c=(0,u.l)(a,"default"),d=(0,u.l)(a,"config"),p=new n.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/pageincludes",pathname:"/api/pageincludes",bundlePath:"",filename:""},userland:a})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[4222,3919],()=>__webpack_exec__(6657));module.exports=s})();