exports.id=3825,exports.ids=[3825],exports.modules={837:e=>{e.exports={tabcontent:"Assets_tabcontent__ARVbl",filelist:"Assets_filelist__y2VRd",file:"Assets_file__Kz8Vw",dark:"Assets_dark__BVRuM",fileactive:"Assets_fileactive__Qdh8h",filepreview:"Assets_filepreview__2emmZ",imagepreview:"Assets_imagepreview__eKqc8",uploadpanel:"Assets_uploadpanel__kPgZI",dropcontainer:"Assets_dropcontainer__fldnp",dropmessage:"Assets_dropmessage__PuXjx",fileinput:"Assets_fileinput__3o9oY",fileunsupportedmessage:"Assets_fileunsupportedmessage__LUaV7",filedisplaycontainer:"Assets_filedisplaycontainer__G_rp9",filestatusbar:"Assets_filestatusbar__etpem",fileinfo:"Assets_fileinfo__Fjtgs",fileremove:"Assets_fileremove__2X3H9",filetypelogo:"Assets_filetypelogo__2cvdx",filetype:"Assets_filetype__BBfyb",filename:"Assets_filename__d5DM6",filesize:"Assets_filesize__umrs8",fileerror:"Assets_fileerror__aHhgB",fileerrormessage:"Assets_fileerrormessage__1uKPf",progress:"Assets_progress__JNTyz",progressbar:"Assets_progressbar__Y0NpG",paneluploading:"Assets_paneluploading__f_yKC"}},3825:(e,l,s)=>{"use strict";s.d(l,{Z:()=>assets});var t=s(997),i=s(6689),a=s.n(i),n=s(837),r=s.n(n);let src_file=function(e){let l=e.path+("/"===e.path.substr(e.path.length-1)?"":"/")+e.added+"/"+e.filename,s=l.split(".").pop();s=s.toLowerCase();let i=l;function selectFile(s){s.target.closest(`.${r().filelist}`).childNodes.forEach(e=>{e.className=`${r().file}`}),s.target.closest("div").className=`${r().file} ${r().fileactive}`,e.onSelectFile(l)}function limit(e="",l=0){return e.length>=l?e.substring(0,l)+"...":e.substring(0,l)}return("jpg"===s||"jpeg"===s||"png"===s||"gif"===s||"webp"===s||"webm"===s)&&(i=e.path+("/"===e.path.substr(e.path.length-1)?"":"/")+e.added+"/thumbs/"+e.filename),"jpg"===s||"jpeg"===s||"png"===s||"gif"===s||"webp"===s||"webm"===s||"ico"===s?(0,t.jsxs)("div",{tabIndex:"0",role:"button",onFocus:selectFile,onKeyDown:function(l){"Enter"===l.key&&e.select&&e.onFinishSelectFile(l)},className:`${r().file} ${e.selected?r().fileactive:""}`,onClick:selectFile,children:[t.jsx("span",{className:r().filepreview,children:t.jsx("img",{src:i,alt:e.filename,className:r().imagepreview})}),t.jsx("span",{style:{fontSize:"13px"},children:limit(e.filename,15)})]}):"mp4"===s?(0,t.jsxs)("div",{tabIndex:"0",role:"button",onFocus:selectFile,className:`${r().file} ${e.selected?r().fileactive:""}`,onClick:selectFile,children:[t.jsx("span",{children:function(e,l,s){if("video"===e)return t.jsx("svg",{style:{width:"50px",height:"50px",marginLeft:"10px",marginTop:"10px"},viewBox:"0 0 512 512",children:t.jsx("path",{d:"M0 360h400v-336h-400v336zM72 40v48h-56v-48h56zM72 104v48h-56v-48h56zM72 168v48h-56v-48h56zM72 232v48h-56v-48h56zM72 296v48h-56v-48h56zM312 40v144h-224v-144h224zM312 200v144h-224v-144h224zM384 40v48h-56v-48h56zM384 104v48h-56v-48h56zM384 168v48h-56v-48 h56zM384 232v48h-56v-48h56zM384 296v48h-56v-48h56z"})})}("video",0,0)}),t.jsx("span",{style:{fontSize:"13px"},children:limit(e.filename,15)})]}):null};var o=s(4080),c=s(9709),d=s(2987),p=s.n(d);let deletefile=function(e){let[l,s]=(0,i.useState)(!1);async function deleteHandler(l){l.preventDefault();let t=e.filename.split("\\").pop().split("/").pop(),i=e.filename.replace(`/${t}`,""),a=await fetch("/api/deletefile",{method:"POST",body:JSON.stringify({filename:t,dateAdded:i}),header:{"Content-Type":"application/json"}});(a=await a.json()).error?(alert(a.error),s(!1)):e.onFileDeleted(()=>{s(!1)})}return(0,t.jsxs)(t.Fragment,{children:[t.jsx("button",{className:"button-normal my-1",onClick:function(e){e.preventDefault(),s(!0)},children:"Delete file permanently"}),t.jsx(o.u,{appear:!0,show:l,as:i.Fragment,children:t.jsx(c.V,{as:"div",className:`${p().dashboard} fixed inset-0 z-10 overflow-y-auto`,onClose:function(){s(!1)},children:(0,t.jsxs)("div",{className:"min-h-screen px-4 text-center w-full",children:[t.jsx(o.u.Child,{as:i.Fragment,enter:"ease-out duration-100",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx(c.V.Overlay,{className:"fixed inset-0 backdrop-blur-sm modal-overlay"})}),t.jsx("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"â€‹"}),t.jsx(o.u.Child,{as:i.Fragment,enter:"ease-out duration-100",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-100",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,t.jsxs)("div",{className:`${p().modal}`,children:[t.jsx("p",{style:{marginBottom:"40px"},children:"Are you sure you want to delete this file?"}),t.jsx("h3",{children:e.filename.split("\\").pop().split("/").pop()}),t.jsx("div",{className:"form-actions",style:{marginTop:"40px"},children:t.jsx("button",{className:"button-warning w-full",onClick:deleteHandler,children:"Delete"})})]})})]})})})]})},dropzone=e=>{let[l,s]=(0,i.useState)([]),[n,o]=(0,i.useState)(""),[c,d]=(0,i.useState)([]),[p,f]=(0,i.useState)([]),h=a().createRef(),m=a().createRef(),u=a().createRef(),g=a().createRef();(0,i.useEffect)(()=>{d([...l.reduce((e,l)=>{let s=e.find(e=>e.name===l.name);return s?e:e.concat([l])},[])])},[l]);let fileSize=e=>{if(0===e)return"0 Bytes";let l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][l]},fileType=e=>e.substring(e.lastIndexOf(".")+1,e.length)||e,validateFile=e=>-1!==["image/jpeg","image/jpg","image/png","image/gif","image/vnd.microsoft.icon","image/webp","image/webm","image/x-icon","video/mp4"].indexOf(e.type),handleFiles=e=>{for(let l=0;l<e.length;l++)validateFile(e[l])?s(s=>[...s,e[l]]):(e[l].invalid=!0,s(s=>[...s,e[l]]),o("File type not permitted"),f(s=>[...s,e[l]]))},removeFile=e=>{let t=c.findIndex(l=>l.name===e);c.splice(t,1),d([...c]);let i=l.findIndex(l=>l.name===e);l.splice(i,1),s([...l]);let a=p.findIndex(l=>l.name===e);-1!==a&&(p.splice(a,1),f([...p]))},showSvgIcon=(e,l,s)=>"document"===e?t.jsx("svg",{style:{width:l+"px",height:s+"px"},viewBox:"0 0 512 512",children:t.jsx("path",{d:"M399.3 168.9c-.7-2.9-2-5-3.5-6.8l-83.7-91.7c-1.9-2.1-4.1-3.1-6.6-4.4-2.9-1.5-6.1-1.6-9.4-1.6H136.2c-12.4 0-23.7 9.6-23.7 22.9v335.2c0 13.4 11.3 25.9 23.7 25.9h243.1c12.4 0 21.2-12.5 21.2-25.9V178.4c0-3.6-.4-6.2-1.2-9.5zM305.5 111l58 63.5h-58V111zm-161 305.5v-320h129v81.7c0 14.8 13.4 28.3 28.1 28.3h66.9v210h-224z"})}):"delete"===e?t.jsx("svg",{style:{width:l+"px",height:s+"px"},viewBox:"0 0 512 512",children:t.jsx("path",{d:"M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z"})}):void 0,uploadSingleFile=async(e,l)=>{let s=new FormData;s.append("file",e),await fetch("/api/upload",{method:"POST",body:s}).then(e=>e.json()).then(e=>{l&&l(e)})};return(0,t.jsxs)("div",{className:r().uploadpanel,children:[0===p.length&&c.length?t.jsx("button",{className:"button-normal",style:{transform:"translateY(-45px)"},onClick:l=>{l.preventDefault(),m.current.style.display="block",u.current.innerHTML="File(s) Uploading...";let t=0;for(let l=0;l<c.length;l++)uploadSingleFile(c[l],()=>{++t===c.length&&(m.current.style.display="",c.length=0,d([...c]),s([...c]),f([...c]),e.onFilesUploaded())})},children:"Upload Files"}):"",p.length?t.jsx("p",{className:r().fileunsupportedmessage,children:"Please remove all unsupported files."}):"",(0,t.jsxs)("div",{className:r().dropcontainer,onDragOver:e=>{e.preventDefault()},onDragEnter:e=>{e.preventDefault()},onDragLeave:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let l=e.dataTransfer.files;l.length&&handleFiles(l)},onClick:()=>{h.current.click()},children:[t.jsx("div",{className:r().dropmessage,children:"Drag & Drop files here or click to upload"}),t.jsx("input",{ref:h,className:r().fileinput,type:"file",multiple:!0,onChange:()=>{h.current.files.length&&handleFiles(h.current.files)}})]}),t.jsx("div",{className:r().filedisplaycontainer,children:c.map((e,l)=>(0,t.jsxs)("div",{className:r().filestatusbar,children:[(0,t.jsxs)("div",{className:r().fileinfo,children:[t.jsx("div",{className:r().filetypelogo,children:showSvgIcon("document",20,20)}),t.jsx("div",{className:r().filetype,children:fileType(e.name)}),t.jsx("span",{className:`${r().filename} ${e.invalid?r().fileerror:""}`,children:e.name}),(0,t.jsxs)("span",{className:r().filesize,children:["(",fileSize(e.size),")"]})]}),t.jsx("div",{className:r().fileremove,onClick:()=>removeFile(e.name),children:showSvgIcon("delete",20,20)}),e.invalid&&(0,t.jsxs)("span",{className:r().fileerrormessage,children:["(",n,")"]})]},l))}),(0,t.jsxs)("div",{className:r().paneluploading,ref:m,children:[t.jsx("span",{ref:u}),t.jsx("div",{className:r().progress,children:t.jsx("div",{className:r().progressbar,ref:g})})]})]})};var f=s(9965);let assets=function(e){let l=(0,i.useRef)(null),[s,n]=(0,i.useState)(),[o,c]=(0,i.useState)({limit:25,offset:0}),[d,h]=(0,i.useState)(0),[m,u]=(0,i.useState)(),g=a().createRef();async function getFiles(e){let l=await fetch("/api/readfiles",{method:"POST",body:JSON.stringify({}),header:{"Content-Type":"application/json"}});(l=await l.json()).error?(alert(l.error),n({ok:!0,status:200,files:[]})):(e&&e(),n(l))}function selectFileHandler(e){g.current.value=e;let l=e.split("\\").pop().split("/").pop(),s=e.replace(`/${l}`,"").split("\\").pop().split("/").pop();u(s+"/"+l)}function pickFileHandler(l){l.preventDefault();let s=g.current.value,t=s.split(".").pop();t=t.toLowerCase();let i=!1;"all"===e.fileType?i=!0:"media"===e.fileType?"jpg"===t||"jpeg"===t||"png"===t||"gif"===t||"webp"===t||"webm"===t||"ico"===t||"mp4"===t?i=!0:alert("Please select an image or video file."):"image"===e.fileType?"jpg"===t||"jpeg"===t||"png"===t||"gif"===t||"webp"===t||"webm"===t||"ico"===t?i=!0:alert("Please select an image file."):"video"===e.fileType&&("mp4"===t?i=!0:alert("Please select an mp4 file.")),i&&e.onPickFile(s)}return(0,i.useEffect)(()=>{getFiles()},[]),t.jsx(t.Fragment,{children:(0,t.jsxs)(f.O.Group,{selectedIndex:d,onChange:h,children:[t.jsx("div",{className:"flex justify-center items-start",children:(0,t.jsxs)(f.O.List,{className:"flex relative z-10 justify-center p-1 space-x-3 bg-white dark:bg-[#7676803D] w-50 rounded-lg",children:[t.jsx(f.O,{as:i.Fragment,children:({selected:e})=>t.jsx("button",{className:e?p().tabactive:p().tab,children:"Browse"})}),t.jsx(f.O,{as:i.Fragment,children:({selected:e})=>t.jsx("button",{className:e?p().tabactive:p().tab,children:"Upload"})})]})}),(0,t.jsxs)(f.O.Panels,{children:[(0,t.jsxs)(f.O.Panel,{className:r().tabcontent,children:[t.jsx("div",{ref:l,className:r().filelist,onScroll:function(e){let l=e.target.scrollHeight-e.target.scrollTop===e.target.clientHeight;l&&c({offset:0,limit:o.limit+25})},children:s?s.files.slice(o.offset,o.limit).map((l,i)=>t.jsx(src_file,{select:e.select,path:s.path,filename:l.filename,added:l.added,fileType:"all",selected:!1,onSelectFile:selectFileHandler,onFinishSelectFile:pickFileHandler},`list${i}`)):t.jsx("p",{children:"Loading..."})}),(0,t.jsxs)("div",{className:"flex",style:{padding:"10px 40px 40px",height:"124px",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-end"},children:[t.jsx("div",{className:"flex",style:{height:50,width:"100%",justifyContent:"space-between"},children:m?t.jsx(deletefile,{onFileDeleted:function(e){getFiles(()=>{e&&e(),g.current.value="",u(null);let s=l.current.querySelectorAll("[role=button]");s.forEach(e=>{-1!==e.className.indexOf("fileactive")&&(e.className=e.className.replace("fileactive",""))})})},filename:m}):t.jsx("div",{})}),(0,t.jsxs)("div",{style:{display:"flex",width:"100%"},children:[t.jsx("input",{type:"text",id:"fileInput",ref:g}),e.select?t.jsx("button",{className:"button-normal ml-2",onClick:pickFileHandler,children:"Select"}):null]})]})]}),t.jsx(f.O.Panel,{className:r().tabcontent,children:t.jsx(dropzone,{onFilesUploaded:()=>{h(0),getFiles()}})})]})]})})}}};